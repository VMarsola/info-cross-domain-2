<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Document</title>
  </head>
  <body>
    <script>
      var PERMITTED_DOMAIN = "https://info-cross-domain1.vercel.app/";
      /**
       * Receiving message from other domain
       */
      console.log("fora do listener");
      window.addEventListener("message", function (event) {
        alert("chegou!");
        console.log("event message triggered", event);

        if (event.origin === PERMITTED_DOMAIN) {
          var msg = JSON.parse(event.data);
          var msgKey = Object.keys(msg)[0];
          if (event.data) {
            console.log(event.data);
            localStorage.setItem("localstorage", event.data);
          } else {
            // localStorage.removeItem("localstorage");
          }
        }
      });
    </script>
    <h1>opa, acessou o domain 2</h1>
  </body>
</html>
